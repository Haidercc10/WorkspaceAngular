<app-menuLateral></app-menuLateral>

<div class="d-flex justify-content-center overlay" *ngIf="cargando">
  <div class="spinner-border text-danger" role="status" style="margin: auto;">
    <span class="visually-hidden">Cargando...</span>
  </div>
</div>

<div class="contain">
  <!-- Navegador fin de parte superior -->
  <div class="container-fluid">
    <!-- principal -->
    <div class="mb-4 Titulo">
      <h2 class="tituloRojo">Pedidos de Productos</h2>
    </div>

    <div class="mb-4">
      <hr class="colorLinea">
    </div>
  </div>
</div>

<div class="contain">

  <div class="container">
  </div>

  <!-- Tabla de Pedidos -->
  <div class="container-fluid tablaDatos">
    <div>
      <div *ngIf="!cargando" id="tableProcesos" style="font-size: 14px;">
        <div class="mb-4 ">
          <div class="row g-3">
            <p-table
              #dt
              [columns]="columnasSeleccionada"
              [value]="ArrayDocumento"
              [resizableColumns]="true"
              columnResizeMode="expand"
              styleClass="p-datatable-gridlines p-datatable-sm"
              responsiveLayout="scroll"
              [paginator]="true"
              [rows]="20"
              [showCurrentPageReport]="true"
              [(first)]="first"
              currentPageReportTemplate="Mostrando del {first} al {last} de {totalRecords} registros"
              [rowsPerPageOptions]="[10,20,30,50,70,100, ArrayDocumento.length]"
              [rowHover]="true"
              dataKey="id">
              <!-- Columnas Seleccionables -->
              <ng-template pTemplate="caption">
                <p-multiSelect
                  [options]="columnas"
                  [(ngModel)]="columnasSeleccionada"
                  optionLabel="header"
                  selectedItemsLabel="{0} columnas seleccionadas"
                  [style]="{minWidth: '330px'}"
                  placeholder="Elige las columnas que quieres ver"></p-multiSelect>
              </ng-template>

              <!-- Columnas Principales -->
              <ng-template pTemplate="header" let-columns>
                <tr>
                  <th style="text-align: center;" scope="col" pSortableColumn="consecutivo">Consecutivo
                    <p-sortIcon field="consecutivo"></p-sortIcon>
                    <p-columnFilter type="numeric" field="consecutivo" display="menu"></p-columnFilter>
                  </th>
                  <th style="text-align: center;" scope="col" pSortableColumn="cliente">Cliente
                    <p-sortIcon field="cliente"></p-sortIcon>
                    <p-columnFilter type="numeric" field="cliente" display="menu"></p-columnFilter>
                  </th>
                  <th style="text-align: center;" scope="col" pSortableColumn="producto">Producto
                    <p-sortIcon field="producto"></p-sortIcon>
                    <p-columnFilter type="numeric" field="producto" display="menu"></p-columnFilter>
                  </th>
                  <th style="text-align: center;" scope="col" pSortableColumn="cant_Pedida">Cant. Pedida
                    <p-sortIcon field="cant_Pedida"></p-sortIcon>
                    <p-columnFilter type="numeric" field="cant_Pedida" display="menu"></p-columnFilter>
                  </th>
                  <th style="text-align: center;" scope="col" pSortableColumn="cant_Pendiente">Cant. Pendiente
                    <p-sortIcon field="cant_Pendiente"></p-sortIcon>
                    <p-columnFilter type="numeric" field="cant_Pendiente" display="menu"></p-columnFilter>
                  </th>
                  <th style="text-align: center;" scope="col" pSortableColumn="cant_Facturada">Cant. Facturada
                    <p-sortIcon field="cant_Facturada"></p-sortIcon>
                    <p-columnFilter type="numeric" field="cant_Facturada" display="menu"></p-columnFilter>
                  </th>
                  <th style="text-align: center;" scope="col" pSortableColumn="existencias">Existencias
                    <p-sortIcon field="existencias"></p-sortIcon>
                    <p-columnFilter type="numeric" field="existencias" display="menu"></p-columnFilter>
                  </th>
                  <th style="text-align: center;" scope="col" pSortableColumn="presentacion">Presentacion
                    <p-sortIcon field="presentacion"></p-sortIcon>
                    <p-columnFilter type="numeric" field="presentacion" display="menu"></p-columnFilter>
                  </th>
                  <th style="text-align: center;" scope="col" pSortableColumn="precioUnidad">Precio Und
                    <p-sortIcon field="precioUnidad"></p-sortIcon>
                    <p-columnFilter type="numeric" field="precioUnidad" display="menu"></p-columnFilter>
                  </th>
                  <th style="text-align: center;" scope="col" pSortableColumn="vendedor">Vendedor
                    <p-sortIcon field="vendedor"></p-sortIcon>
                    <p-columnFilter type="numeric" field="vendedor" display="menu"></p-columnFilter>
                  </th>
                  <th style="text-align: center;" scope="col" pSortableColumn="orden_Compra_CLiente">OC CLiente
                    <p-sortIcon field="orden_Compra_CLiente"></p-sortIcon>
                    <p-columnFilter type="numeric" field="orden_Compra_CLiente" display="menu"></p-columnFilter>
                  </th>
                  <th style="text-align: center;" scope="col" pSortableColumn="costo_Cant_Pendiente">Costo Cant Pendiente
                    <p-sortIcon field="costo_Cant_Pendiente"></p-sortIcon>
                    <p-columnFilter type="numeric" field="costo_Cant_Pendiente" display="menu"></p-columnFilter>
                  </th>
                  <th style="text-align: center;" scope="col" pSortableColumn="costo_Cant_Total">Costo Cant Total
                    <p-sortIcon field="costo_Cant_Total"></p-sortIcon>
                    <p-columnFilter type="numeric" field="costo_Cant_Total" display="menu"></p-columnFilter>
                  </th>
                  <th style="text-align: center;" scope="col" pSortableColumn="fecha_Creacion">Fecha Creacion
                    <p-sortIcon field="fecha_Creacion"></p-sortIcon>
                    <p-columnFilter type="numeric" field="fecha_Creacion" display="menu"></p-columnFilter>
                  </th>
                  <th style="text-align: center;" scope="col" pSortableColumn="fecha_Entrega">Fecha Entrega
                    <p-sortIcon field="fecha_Entrega"></p-sortIcon>
                    <p-columnFilter type="numeric" field="fecha_Entrega" display="menu"></p-columnFilter>
                  </th>
                </tr>
              </ng-template>

              <!-- Cuerpo de la tabla -->
              <ng-template pTemplate="body" let-data let-columns="columns">
                <tr style="cursor: pointer;">
                  <td scope="col">{{data.consecutivo}}</td>
                  <td scope="col">{{data.cliente}}</td>
                  <td scope="col">{{data.producto}}</td>
                  <td scope="col">{{data.cant_Pedida | number : '1.2-2'}}</td>
                  <td scope="col">{{data.cant_Pendiente | number : '1.2-2'}}</td>
                  <td scope="col">{{data.cant_Facturada | number : '1.2-2'}}</td>
                  <td scope="col">{{data.existencias | number : '1.2-2'}}</td>
                  <td scope="col">{{data.presentacion}}</td>
                  <td scope="col">{{data.precioUnidad | number : '1.2-2'}}</td>
                  <td scope="col">{{data.vendedor}}</td>
                  <td scope="col">{{data.orden_Compra_CLiente}}</td>
                  <td scope="col">{{data.costo_Cant_Pendiente | number : '1.2-2'}}</td>
                  <td scope="col">{{data.costo_Cant_Total | number : '1.2-2'}}</td>
                  <td scope="col">{{data.fecha_Creacion | date : 'yyyy-MM-dd'}}</td>
                  <td scope="col">{{data.fecha_Entrega | date : 'yyyy-MM-dd'}}</td>
                </tr>
              </ng-template>

              <!-- Footer de la Tabla -->
              <ng-template pTemplate="footer" *ngIf="ValidarRol == 1">
                <tr>
                  <td colspan="15" class="text-right">
                  </td>
                </tr>
              </ng-template>

              <ng-template pTemplate="summary">
                <div class="p-d-flex p-ai-center p-jc-between">
                  En total hay {{ArrayDocumento ? ArrayDocumento.length : 0 | number : '1.2-2'}} Pedido(s).
                </div>
              </ng-template>
            </p-table>

          </div>
        </div>
      </div>
    </div>
  </div>
</div>
