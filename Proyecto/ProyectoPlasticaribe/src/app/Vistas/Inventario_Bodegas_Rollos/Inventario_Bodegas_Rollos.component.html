

<div class="d-flex justify-content-center overlay" *ngIf="cargando">
  <div style="margin: auto;">
    <p-progressSpinner></p-progressSpinner>
  </div>
</div>

<div class="contain">
  <div class="container-fluid">
    <div class="mb-4 Titulo">
      <h2 [ngClass]="{'tituloRojo': !modoSeleccionado, 'tituloClaro': modoSeleccionado}">Inventario de Bodega de Rollos {{currentStore}}</h2>
    </div>

    <div class="mb-4">
      <hr class="colorLinea">
    </div>
  </div>
</div>

<p-card class="font-size-14">
  <div class="d-grid gap-2 d-md-flex justify-content-md-end" *ngIf="[95,1].includes(ValidarRol)">
    <button pButton pRipple label="Cambiar Ubicación" icon="pi pi-arrow-right-arrow-left"class="p-button-outlined p-button-success" id="reubicar" (click)="changeUbications = true"></button>
    <p-button icon="pi pi-eye" label="Ver Plano Bodega" styleClass="p-button-rounded p-button-warning" (click)="warehouse = true" tooltipPosition="top"></p-button>
  </div>

  <p-tabView [scrollable]="true" id="seleccionInventarios" (onChange)="changeTab($event)">
    <!-- INVENTARIO TOTAL -->
    <!--<p-tabPanel
      header="Inventario Total"
      leftIcon="pi pi-th-large"
      tooltip="Información del Inventario de Todas las Bodega"
      id="tablasInventario">
      <div class="mb-3" *ngIf="!cargando">
        <div class="row g-3 font-size-14" id="table">
          <p-table
            #dtTotal
            [value]="inventarioTotal"
            [resizableColumns]="true"
            columnResizeMode="expand"
            styleClass="p-datatable-gridlines p-datatable-sm"
            responsiveLayout="scroll"
            [rowHover]="true"
            dataKey="Orden"
            [scrollable]="true"
            scrollHeight="50rem">
            <ng-template pTemplate="header">
              <tr class="font-size-16" id="filtros">
                <th pFrozenColumn alignFrozen="left" [frozen]="true"><button pButton pRipple pTooltip="Exportar a Excel" icon="pi pi-file-excel" class="p-button-success" id="exportar2" (click)="crearExcel(1)"></button></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Orden', 'contains', dtTotal)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Item', 'contains', dtTotal)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Referencia', 'contains', dtTotal)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Cantidad', 'contains', dtTotal)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Presentacion', 'contains', dtTotal)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Rollos', 'contains', dtTotal)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'BodegaActual', 'contains', dtTotal)"></th>
                <th pFrozenColumn alignFrozen="right" [frozen]="true"></th>
              </tr>
              <tr>
                <th pFrozenColumn alignFrozen="left" [frozen]="true">#</th>
                <th pSortableColumn="Orden">Orden Trabajo <p-sortIcon field="Orden"></p-sortIcon></th>
                <th pSortableColumn="Item">Item <p-sortIcon field="Item"></p-sortIcon></th>
                <th pSortableColumn="Referencia">Referencia <p-sortIcon field="Referencia"></p-sortIcon></th>
                <th pSortableColumn="Cantidad">Cantidad <p-sortIcon field="Cantidad"></p-sortIcon></th>
                <th pSortableColumn="Presentacion">Presentación <p-sortIcon field="Presentacion"></p-sortIcon></th>
                <th pSortableColumn="Rollos">Rollos <p-sortIcon field="Rollos"></p-sortIcon></th>
                <th pSortableColumn="BodegaActual">Bodega Actual <p-sortIcon field="BodegaActual"></p-sortIcon></th>
                <th pFrozenColumn alignFrozen="right" [frozen]="true">Ver</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-data let-rowIndex="rowIndex" id="cuerpo">
              <tr>
                <td pFrozenColumn alignFrozen="left" [frozen]="true">{{rowIndex + 1}}</td>
                <td class="negrita">{{data.Orden}}</td>
                <td>{{data.Item}}</td>
                <td class="negrita">{{data.Referencia}}</td>
                <td class="negrita">{{data.Cantidad | number : '1.2-2'}}</td>
                <td>{{data.Presentacion}}</td>
                <td class="negrita">{{data.Rollos | number : '1.2-2'}}</td>
                <td><span class="badge" [ngClass]="{'bg-Extrusion': data.BodegaActual == 'Extrusion',
                                      'bg-ProductoIntermedio': data.BodegaActual == 'Producto Intermedio',
                                      'bg-Impresion': data.BodegaActual == 'Impresion',
                                      'bg-Rotograbado': data.BodegaActual == 'Rotograbado',
                                      'bg-Sellado': data.BodegaActual == 'Sellado',
                                      'bg-Despacho': data.BodegaActual == 'Despacho'}">{{data.BodegaActual | uppercase}}</span></td>
                <td style="text-align: center;" pFrozenColumn alignFrozen="right" [frozen]="true"><p-button id="botonDetalles" icon="pi pi-eye" styleClass="p-button-rounded p-button-success" (click)="consultarDetallesInventario(data.Orden, data.Bodega)"></p-button></td>
              </tr>
            </ng-template>
            <ng-template pTemplate="footer" id="totales">
              <tr>
                <td colspan="4">Totales: </td>
                <td>{{calcularTotalKg(inventarioTotal) | number : '1.2-2'}}</td>
                <td>Kg</td>
                <td colspan="3">{{calcularTotalRollos(inventarioTotal) | number : '1.2-2'}}</td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>
    </p-tabPanel>-->

    <!-- EXTRUSIÓN -->
    <!--<p-tabPanel
      header="Extrusión"
      leftIcon="pi pi-bolt"
      tooltip="Información del Inventario de la Bodega de Extrusión">
      <div class="mb-3" *ngIf="!cargando">
        <div class="row g-3 font-size-14" id="table">
          <p-table
          #dtExtrusion
          [value]="inventarioExtrusion"
          [resizableColumns]="true"
          columnResizeMode="expand"
          styleClass="p-datatable-gridlines p-datatable-sm"
          responsiveLayout="scroll"
          [rowHover]="true"
          dataKey="Orden"
          [scrollable]="true"
          scrollHeight="50rem">
          <ng-template pTemplate="header" >
            <tr class="font-size-16">
              <th pFrozenColumn alignFrozen="left" [frozen]="true"><button pButton pRipple pTooltip="Exportar a Excel" icon="pi pi-file-excel" class="p-button-success" id="exportar3" (click)="crearExcel(2)"></button></th>
              <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Orden', 'contains', dtExtrusion)"></th>
              <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Item', 'contains', dtExtrusion)"></th>
              <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Referencia', 'contains', dtExtrusion)"></th>
              <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Cantidad', 'contains', dtExtrusion)"></th>
              <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Presentacion', 'contains', dtExtrusion)"></th>
              <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Rollos', 'contains', dtExtrusion)"></th>
              <th pFrozenColumn alignFrozen="right" [frozen]="true"></th>
            </tr>
            <tr class="font-size-16">
              <th pFrozenColumn alignFrozen="left" [frozen]="true">#</th>
              <th pSortableColumn="Orden">Orden Trabajo <p-sortIcon field="Orden"></p-sortIcon></th>
              <th pSortableColumn="Item">Item <p-sortIcon field="Item"></p-sortIcon></th>
              <th pSortableColumn="Referencia">Referencia <p-sortIcon field="Referencia"></p-sortIcon></th>
              <th pSortableColumn="Cantidad">Cantidad <p-sortIcon field="Cantidad"></p-sortIcon></th>
              <th pSortableColumn="Presentacion">Presentación <p-sortIcon field="Presentacion"></p-sortIcon></th>
              <th pSortableColumn="Rollos">Rollos <p-sortIcon field="Rollos"></p-sortIcon></th>
              <th pFrozenColumn alignFrozen="right" [frozen]="true">Ver</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-data let-rowIndex="rowIndex">
            <tr>
              <td pFrozenColumn alignFrozen="left" [frozen]="true">{{rowIndex + 1}}</td>
              <td class="negrita">{{data.Orden}}</td>
              <td>{{data.Item}}</td>
              <td class="negrita">{{data.Referencia}}</td>
              <td class="negrita">{{data.Cantidad | number : '1.2-2'}}</td>
              <td>{{data.Presentacion}}</td>
              <td class="negrita">{{data.Rollos | number : '1.2-2'}}</td>
              <td style="text-align: center;" pFrozenColumn alignFrozen="right" [frozen]="true"><p-button id="botonDetalles" icon="pi pi-eye" styleClass="p-button-rounded p-button-success" (click)="consultarDetallesInventario(data.Orden, data.Bodega)"></p-button></td>
            </tr>
          </ng-template>
          <ng-template pTemplate="footer">
            <tr>
              <td colspan="4">Totales: </td>
              <td>{{calcularTotalKg(inventarioExtrusion) | number : '1.2-2'}}</td>
              <td>Kg</td>
              <td colspan="2">{{calcularTotalRollos(inventarioExtrusion) | number : '1.2-2'}}</td>
            </tr>
          </ng-template>
        </p-table>
        </div>
      </div>
    </p-tabPanel>-->

    <!--* PRODUCTO INTERMEDIO -->
    <p-tabPanel
      *ngIf="[95,1].includes(ValidarRol)"
      header="Producto Intermedio"
      leftIcon="pi pi-box"
      tooltip="Información del Inventario de la Bodega de Producto Intermedio">

      <!--* Botón Excel-->
      <p-toolbar styleClass="mb-3 gap-3">
        <div class="row" style="width: 100%;">
          <div class="d-grid gap-2 d-md-flex justify-content-md-end p-2">
            <button pButton pRipple label="Exportar a Excel" icon="pi pi-file-excel"class="p-button-success" id="exportar1" (click)="crearExcel(3)"></button>
          </div>
        </div>
      </p-toolbar>
      
      <!--*Tabla 1-->
      <div class="mb-3" *ngIf="!cargando">
        <div class="row g-3" id="table">
          <p-table
            #dtProductoIntermedio
            [value]="inventarioProductoIntermedio"
            [resizableColumns]="true"
            columnResizeMode="expand"
            styleClass="p-datatable-gridlines p-datatable-sm"
            responsiveLayout="scroll"
            [rowHover]="true"
            dataKey="Orden"
            [scrollable]="true"
            scrollHeight="50rem">
            <ng-template pTemplate="header" >
              <tr>
                <th></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Orden', 'contains', dtProductoIntermedio)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Cliente', 'contains', dtProductoIntermedio)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Item', 'contains', dtProductoIntermedio)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Referencia', 'contains', dtProductoIntermedio)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Cantidad', 'contains', dtProductoIntermedio)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Material', 'contains', dtProductoIntermedio)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Ancho', 'contains', dtProductoIntermedio)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Unidad', 'contains', dtProductoIntermedio)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Rollos', 'contains', dtProductoIntermedio)"></th>
                <th pFrozenColumn alignFrozen="right" [frozen]="true"></th>
              </tr>
              <tr>
                <th class="text-center" pFrozenColumn alignFrozen="left" [frozen]="true">#</th>
                <th class="text-center" pSortableColumn="Orden">Orden Trabajo <p-sortIcon field="Orden"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Cliente">Cliente <p-sortIcon field="Cliente"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Item">Item <p-sortIcon field="Item"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Referencia">Referencia <p-sortIcon field="Referencia"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Cantidad">Cantidad (Kg)<p-sortIcon field="Cantidad"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Material">Material <p-sortIcon field="Material"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Ancho">Ancho <p-sortIcon field="Ancho"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Unidad">Unidad <p-sortIcon field="Unidad"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Rollos">Cant. Rollos <p-sortIcon field="Rollos"></p-sortIcon></th>
                <th class="text-center" pFrozenColumn alignFrozen="right" [frozen]="true">Ver</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-data let-rowIndex="rowIndex">
              <tr>
                <td pFrozenColumn alignFrozen="left" [frozen]="true">{{rowIndex + 1}}</td>
                <td class="text-center negrita">{{data.Orden}}</td>
                <td>{{data.Cliente}}</td>
                <td class="text-center negrita">{{data.Item}}</td>
                <td>{{data.Referencia}}</td>
                <td class="text-center negrita textGreen">{{data.Cantidad | number : '1.2-2'}}</td>
                <td class="text-center">{{data.Material}}</td>
                <td class="text-center"><b>{{data.Ancho | number : '1.2-2'}}</b></td>
                <td class="text-center">{{data.Unidad}}</td>
                <td class="text-center negrita textGreen">{{data.Rollos}}</td>
                <td class="text-center" style="text-align: center;" pFrozenColumn alignFrozen="right" [frozen]="true"><p-button id="botonDetalles" icon="pi pi-eye" styleClass="p-button-rounded p-button-success" (click)="consultarDetallesInventario(data.Cliente, data.Orden, data.Bodega)"></p-button></td>
              </tr>
            </ng-template>
            <ng-template pTemplate="footer">
              <tr>
                <td class="text-right" colspan="5">Totales: </td>
                <td class="text-center textGreen">{{calcularTotalKg(dtProductoIntermedio, inventarioProductoIntermedio) | number : '1.2-2'}}</td>
                <td class="text-center">Kg</td>
                <td class="text-center" colspan="2"></td>
                <td class="text-center textGreen">{{calcularTotalRollos(dtProductoIntermedio, inventarioProductoIntermedio)}}</td>
                <td></td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>
    </p-tabPanel>

    <!--* EXTRUSIÓN -->
    <!--<p-tabPanel
      *ngIf="[85,1].includes(ValidarRol)"
      header="Extrusion"
      leftIcon="pi pi-print"
      tooltip="Información del Inventario de la Bodega de Extrusión">

      <!--* Botón Excel-->
      <!--<p-toolbar styleClass="mb-3 gap-3">
        <div class="row" style="width: 100%;">
          <div class="d-grid gap-2 d-md-flex justify-content-md-end p-2">
            <button pButton pRipple label="Exportar a Excel" icon="pi pi-file-excel"class="p-button-success" id="exportar1" (click)="crearExcel(2)"></button>
          </div>
        </div>
      </p-toolbar>-->

      <!--* Tabla-->
      <!--<div class="mb-3" *ngIf="!cargando">
        <div class="row g-3 font-size-14" id="table">
          <p-table
            #dtRotograbado
            [value]="inventarioExtrusion"
            [resizableColumns]="true"
            columnResizeMode="expand"
            styleClass="p-datatable-gridlines p-datatable-sm"
            responsiveLayout="scroll"
            [rowHover]="true"
            dataKey="Orden"
            [scrollable]="true"
            scrollHeight="50rem">
            <ng-template pTemplate="header">
              <tr>
                <th></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Orden', 'contains', dtExtrusion)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Cliente', 'contains', dtExtrusion)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Item', 'contains', dtExtrusion)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Referencia', 'contains', dtExtrusion)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Cantidad', 'contains', dtExtrusion)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Material', 'contains', dtExtrusion)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Ancho', 'contains', dtExtrusion)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Unidad', 'contains', dtExtrusion)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Rollos', 'contains', dtExtrusion)"></th>
                <th pFrozenColumn alignFrozen="right" [frozen]="true"></th>
              </tr>
              <tr>
                <th class="text-center" pFrozenColumn alignFrozen="left" [frozen]="true">#</th>
                <th class="text-center" pSortableColumn="Orden">Orden Trabajo <p-sortIcon field="Orden"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Cliente">Cliente <p-sortIcon field="Cliente"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Item">Item <p-sortIcon field="Item"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Referencia">Referencia <p-sortIcon field="Referencia"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Cantidad">Cantidad (Kg)<p-sortIcon field="Cantidad"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Material">Material <p-sortIcon field="Material"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Ancho">Ancho <p-sortIcon field="Ancho"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Unidad">Unidad <p-sortIcon field="Unidad"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Rollos">Cant. Rollos <p-sortIcon field="Rollos"></p-sortIcon></th>
                <th class="text-center" pFrozenColumn alignFrozen="right" [frozen]="true">Ver</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-data let-rowIndex="rowIndex">
              <tr>
                <td pFrozenColumn alignFrozen="left" [frozen]="true">{{rowIndex + 1}}</td>
                <td class="text-center negrita">{{data.Orden}}</td>
                <td>{{data.Cliente}}</td>
                <td class="text-center negrita">{{data.Item}}</td>
                <td>{{data.Referencia}}</td>
                <td class="text-center negrita textGreen">{{data.Cantidad | number : '1.2-2'}}</td>
                <td class="text-center">{{data.Material}}</td>
                <td class="text-center"><b>{{data.Ancho | number : '1.2-2'}}</b></td>
                <td class="text-center">{{data.Unidad}}</td>
                <td class="text-center negrita textGreen">{{data.Rollos}}</td>
                <td class="text-center" style="text-align: center;" pFrozenColumn alignFrozen="right" [frozen]="true"><p-button id="botonDetalles" icon="pi pi-eye" styleClass="p-button-rounded p-button-success" (click)="consultarDetallesInventario(data.Cliente, data.Orden, data.Bodega)"></p-button></td>
              </tr>
            </ng-template>
            <ng-template pTemplate="footer">
              <tr>
                <td class="text-right" colspan="5">Totales: </td>
                <td class="text-center textGreen">{{calcularTotalKg(dtExtrusion, inventarioExtrusion) | number : '1.2-2'}}</td>
                <td class="text-center">Kg</td>
                <td class="text-center" colspan="2"></td>
                <td class="text-center textGreen">{{calcularTotalRollos(dtExtrusion, inventarioExtrusion)}}</td>
                <td></td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>
    </p-tabPanel>--> 

    <!--* ROTOGRABADO -->
    <p-tabPanel
      *ngIf="[89,1].includes(ValidarRol)"
      header="Rotograbado"
      leftIcon="pi pi-print"
      tooltip="Información del Inventario de la Bodega de Rotograbado">

      <!--* Botón Excel-->
      <p-toolbar styleClass="mb-3 gap-3">
        <div class="row" style="width: 100%;">
          <div class="d-grid gap-2 d-md-flex justify-content-md-end p-2">
            <button pButton pRipple label="Exportar a Excel" icon="pi pi-file-excel"class="p-button-success" id="exportar1" (click)="crearExcel(5)"></button>
          </div>
        </div>
      </p-toolbar>

      <!--* Tabla-->
      <div class="mb-3" *ngIf="!cargando">
        <div class="row g-3 font-size-14" id="table">
          <p-table
            #dtRotograbado
            [value]="inventarioRotograbado"
            [resizableColumns]="true"
            columnResizeMode="expand"
            styleClass="p-datatable-gridlines p-datatable-sm"
            responsiveLayout="scroll"
            [rowHover]="true"
            dataKey="Orden"
            [scrollable]="true"
            scrollHeight="50rem">
            <ng-template pTemplate="header">
              <tr>
                <th></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Orden', 'contains', dtProductoIntermedio)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Cliente', 'contains', dtProductoIntermedio)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Item', 'contains', dtProductoIntermedio)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Referencia', 'contains', dtProductoIntermedio)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Cantidad', 'contains', dtProductoIntermedio)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Material', 'contains', dtProductoIntermedio)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Ancho', 'contains', dtProductoIntermedio)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Unidad', 'contains', dtProductoIntermedio)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Rollos', 'contains', dtProductoIntermedio)"></th>
                <th pFrozenColumn alignFrozen="right" [frozen]="true"></th>
              </tr>
              <tr>
                <th class="text-center" pFrozenColumn alignFrozen="left" [frozen]="true">#</th>
                <th class="text-center" pSortableColumn="Orden">Orden Trabajo <p-sortIcon field="Orden"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Cliente">Cliente <p-sortIcon field="Cliente"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Item">Item <p-sortIcon field="Item"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Referencia">Referencia <p-sortIcon field="Referencia"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Cantidad">Cantidad (Kg)<p-sortIcon field="Cantidad"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Material">Material <p-sortIcon field="Material"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Ancho">Ancho <p-sortIcon field="Ancho"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Unidad">Unidad <p-sortIcon field="Unidad"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Rollos">Cant. Rollos <p-sortIcon field="Rollos"></p-sortIcon></th>
                <th class="text-center" pFrozenColumn alignFrozen="right" [frozen]="true">Ver</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-data let-rowIndex="rowIndex">
              <tr>
                <td pFrozenColumn alignFrozen="left" [frozen]="true">{{rowIndex + 1}}</td>
                <td class="text-center negrita">{{data.Orden}}</td>
                <td>{{data.Cliente}}</td>
                <td class="text-center negrita">{{data.Item}}</td>
                <td>{{data.Referencia}}</td>
                <td class="text-center negrita textGreen">{{data.Cantidad | number : '1.2-2'}}</td>
                <td class="text-center">{{data.Material}}</td>
                <td class="text-center"><b>{{data.Ancho | number : '1.2-2'}}</b></td>
                <td class="text-center">{{data.Unidad}}</td>
                <td class="text-center negrita textGreen">{{data.Rollos}}</td>
                <td class="text-center" style="text-align: center;" pFrozenColumn alignFrozen="right" [frozen]="true"><p-button id="botonDetalles" icon="pi pi-eye" styleClass="p-button-rounded p-button-success" (click)="consultarDetallesInventario(data.Cliente, data.Orden, data.Bodega)"></p-button></td>
              </tr>
            </ng-template>
            <ng-template pTemplate="footer">
              <tr>
                <td class="text-right" colspan="5">Totales: </td>
                <td class="text-center textGreen">{{calcularTotalKg(dtRotograbado, inventarioRotograbado) | number : '1.2-2'}}</td>
                <td class="text-center">Kg</td>
                <td class="text-center" colspan="2"></td>
                <td class="text-center textGreen">{{calcularTotalRollos(dtRotograbado, inventarioRotograbado)}}</td>
                <td></td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>
    </p-tabPanel>

    <!--* CALIDAD -->
    <p-tabPanel
      *ngIf="[95,1].includes(ValidarRol)"
      header="Calidad"
      leftIcon="pi pi-check-square"
      tooltip="Información del Inventario de la Bodega de Productos por Calidad">

      <!--* Botón Excel-->
      <p-toolbar styleClass="mb-3 gap-3">
        <div class="row" style="width: 100%;">
          <div class="d-grid gap-2 d-md-flex justify-content-md-end p-2">
            <button pButton pRipple label="Exportar a Excel" icon="pi pi-file-excel"class="p-button-success" id="exportar1" (click)="crearExcel(5)"></button>
          </div>
        </div>
      </p-toolbar>

      <!--* Tabla-->
      <div class="mb-3" *ngIf="!cargando">
        <div class="row g-3 font-size-14" id="table">
          <p-table
            #dtRotograbado
            [value]="inventarioCalidad"
            [resizableColumns]="true"
            columnResizeMode="expand"
            styleClass="p-datatable-gridlines p-datatable-sm"
            responsiveLayout="scroll"
            [rowHover]="true"
            dataKey="Orden"
            [scrollable]="true"
            scrollHeight="50rem">
            <ng-template pTemplate="header">
              <tr>
                <th></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Orden', 'contains', dtCalidad)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Cliente', 'contains', dtCalidad)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Item', 'contains', dtCalidad)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Referencia', 'contains', dtCalidad)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Cantidad', 'contains', dtCalidad)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Material', 'contains', dtCalidad)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Ancho', 'contains', dtCalidad)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Unidad', 'contains', dtCalidad)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Rollos', 'contains', dtCalidad)"></th>
                <th pFrozenColumn alignFrozen="right" [frozen]="true"></th>
              </tr>
              <tr>
                <th class="text-center" pFrozenColumn alignFrozen="left" [frozen]="true">#</th>
                <th class="text-center" pSortableColumn="Orden">Orden Trabajo <p-sortIcon field="Orden"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Cliente">Cliente <p-sortIcon field="Cliente"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Item">Item <p-sortIcon field="Item"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Referencia">Referencia <p-sortIcon field="Referencia"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Cantidad">Cantidad (Kg)<p-sortIcon field="Cantidad"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Material">Material <p-sortIcon field="Material"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Ancho">Ancho <p-sortIcon field="Ancho"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Unidad">Unidad <p-sortIcon field="Unidad"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Rollos">Cant. Rollos <p-sortIcon field="Rollos"></p-sortIcon></th>
                <th class="text-center" pFrozenColumn alignFrozen="right" [frozen]="true">Ver</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-data let-rowIndex="rowIndex">
              <tr>
                <td pFrozenColumn alignFrozen="left" [frozen]="true">{{rowIndex + 1}}</td>
                <td class="text-center negrita">{{data.Orden}}</td>
                <td>{{data.Cliente}}</td>
                <td class="text-center negrita">{{data.Item}}</td>
                <td>{{data.Referencia}}</td>
                <td class="text-center negrita textGreen">{{data.Cantidad | number : '1.2-2'}}</td>
                <td class="text-center">{{data.Material}}</td>
                <td class="text-center"><b>{{data.Ancho | number : '1.2-2'}}</b></td>
                <td class="text-center">{{data.Unidad}}</td>
                <td class="text-center negrita textGreen">{{data.Rollos}}</td>
                <td class="text-center" style="text-align: center;" pFrozenColumn alignFrozen="right" [frozen]="true"><p-button id="botonDetalles" icon="pi pi-eye" styleClass="p-button-rounded p-button-success" (click)="consultarDetallesInventario(data.Cliente, data.Orden, data.Bodega)"></p-button></td>
              </tr>
            </ng-template>
            <ng-template pTemplate="footer">
              <tr>
                <td class="text-right" colspan="5">Totales: </td>
                <td class="text-center textGreen">{{calcularTotalKg(dtCalidad, inventarioCalidad) | number : '1.2-2'}}</td>
                <td class="text-center">Kg</td>
                <td class="text-center" colspan="2"></td>
                <td class="text-center textGreen">{{calcularTotalRollos(dtCalidad, inventarioCalidad)}}</td>
                <td></td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>
    </p-tabPanel>

    <!--* IMPRESIÓN -->
    <p-tabPanel
      *ngIf="[4,1].includes(ValidarRol)"
      header="Impresión"
      leftIcon="pi pi-print"
      tooltip="Información del Inventario de la Bodega de Productos por Calidad">

      <!--* Botón Excel-->
      <p-toolbar styleClass="mb-3 gap-3">
        <div class="row" style="width: 100%;">
          <div class="d-grid gap-2 d-md-flex justify-content-md-end p-2">
            <button pButton pRipple label="Exportar a Excel" icon="pi pi-file-excel"class="p-button-success" id="exportar1" (click)="crearExcel(4)"></button>
          </div>
        </div>
      </p-toolbar>

      <!--* Tabla -->
      <div class="mb-3" *ngIf="!cargando">
        <div class="row g-3 font-size-14" id="table">
          <p-table
            #dtImpresion
            [value]="inventarioImpresion"
            [resizableColumns]="true"
            columnResizeMode="expand"
            styleClass="p-datatable-gridlines p-datatable-sm"
            responsiveLayout="scroll"
            [rowHover]="true"
            dataKey="Orden"
            [scrollable]="true"
            scrollHeight="50rem">
            <ng-template pTemplate="header">
              <tr>
                <th></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Orden', 'contains', dtImpresion)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Cliente', 'contains', dtImpresion)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Item', 'contains', dtImpresion)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Referencia', 'contains', dtImpresion)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Cantidad', 'contains', dtImpresion)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Material', 'contains', dtImpresion)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Ancho', 'contains', dtImpresion)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Unidad', 'contains', dtImpresion)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Rollos', 'contains', dtImpresion)"></th>
                <th pFrozenColumn alignFrozen="right" [frozen]="true"></th>
              </tr>
              <tr>
                <th class="text-center" pFrozenColumn alignFrozen="left" [frozen]="true">#</th>
                <th class="text-center" pSortableColumn="Orden">Orden Trabajo <p-sortIcon field="Orden"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Cliente">Cliente <p-sortIcon field="Cliente"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Item">Item <p-sortIcon field="Item"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Referencia">Referencia <p-sortIcon field="Referencia"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Cantidad">Cantidad (Kg)<p-sortIcon field="Cantidad"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Material">Material <p-sortIcon field="Material"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Ancho">Ancho <p-sortIcon field="Ancho"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Unidad">Unidad <p-sortIcon field="Unidad"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Rollos">Cant. Rollos <p-sortIcon field="Rollos"></p-sortIcon></th>
                <th class="text-center" pFrozenColumn alignFrozen="right" [frozen]="true">Ver</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-data let-rowIndex="rowIndex">
              <tr>
                <td pFrozenColumn alignFrozen="left" [frozen]="true">{{rowIndex + 1}}</td>
                <td class="text-center negrita">{{data.Orden}}</td>
                <td>{{data.Cliente}}</td>
                <td class="text-center negrita">{{data.Item}}</td>
                <td>{{data.Referencia}}</td>
                <td class="text-center negrita textGreen">{{data.Cantidad | number : '1.2-2'}}</td>
                <td class="text-center">{{data.Material}}</td>
                <td class="text-center"><b>{{data.Ancho | number : '1.2-2'}}</b></td>
                <td class="text-center">{{data.Unidad}}</td>
                <td class="text-center negrita textGreen">{{data.Rollos}}</td>
                <td class="text-center" style="text-align: center;" pFrozenColumn alignFrozen="right" [frozen]="true"><p-button id="botonDetalles" icon="pi pi-eye" styleClass="p-button-rounded p-button-success" (click)="consultarDetallesInventario(data.Cliente, data.Orden, data.Bodega)"></p-button></td>
              </tr>
            </ng-template>
            <ng-template pTemplate="footer">
              <tr>
                <td class="text-right" colspan="5">Totales: </td>
                <td class="text-center textGreen">{{calcularTotalKg(dtImpresion, inventarioImpresion) | number : '1.2-2'}}</td>
                <td class="text-center">Kg</td>
                <td class="text-center" colspan="2"></td>
                <td class="text-center textGreen">{{calcularTotalRollos(dtImpresion, inventarioImpresion)}}</td>
                <td></td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>
    </p-tabPanel>

    <!--* SELLADO -->
    <p-tabPanel
      *ngIf="[86,1].includes(ValidarRol)"
      header="Sellado"
      leftIcon="pi pi-tags"
      tooltip="Información del Inventario de la Bodega de Rollos de Sellado">

      <!--* Botón Excel-->
      <p-toolbar styleClass="mb-3 gap-3">
        <div class="row" style="width: 100%;">
          <div class="d-grid gap-2 d-md-flex justify-content-md-end p-2">
            <button pButton pRipple label="Exportar a Excel" icon="pi pi-file-excel"class="p-button-success" id="exportar1" (click)="crearExcel(6)"></button>
          </div>
        </div>
      </p-toolbar>

      <!--* Tabla -->
      <div class="mb-3" *ngIf="!cargando">
        <div class="row g-3 font-size-14" id="table">
          <p-table
            #dtSellado
            [value]="inventarioSellado"
            [resizableColumns]="true"
            columnResizeMode="expand"
            styleClass="p-datatable-gridlines p-datatable-sm"
            responsiveLayout="scroll"
            [rowHover]="true"
            dataKey="Orden"
            [scrollable]="true"
            scrollHeight="50rem">
            <ng-template pTemplate="header">
              <tr>
                <th></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Orden', 'contains', dtSellado)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Cliente', 'contains', dtSellado)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Item', 'contains', dtSellado)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Referencia', 'contains', dtSellado)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Cantidad', 'contains', dtSellado)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Material', 'contains', dtSellado)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Ancho', 'contains', dtSellado)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Unidad', 'contains', dtSellado)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'Rollos', 'contains', dtSellado)"></th>
                <th pFrozenColumn alignFrozen="right" [frozen]="true"></th>
              </tr>
              <tr>
                <th class="text-center" pFrozenColumn alignFrozen="left" [frozen]="true">#</th>
                <th class="text-center" pSortableColumn="Orden">Orden Trabajo <p-sortIcon field="Orden"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Cliente">Cliente <p-sortIcon field="Cliente"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Item">Item <p-sortIcon field="Item"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Referencia">Referencia <p-sortIcon field="Referencia"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Cantidad">Cantidad (Kg)<p-sortIcon field="Cantidad"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Material">Material <p-sortIcon field="Material"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Ancho">Ancho <p-sortIcon field="Ancho"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Unidad">Unidad <p-sortIcon field="Unidad"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="Rollos">Cant. Rollos <p-sortIcon field="Rollos"></p-sortIcon></th>
                <th class="text-center" pFrozenColumn alignFrozen="right" [frozen]="true">Ver</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-data let-rowIndex="rowIndex">
              <tr>
                <td pFrozenColumn alignFrozen="left" [frozen]="true">{{rowIndex + 1}}</td>
                <td class="text-center negrita">{{data.Orden}}</td>
                <td>{{data.Cliente}}</td>
                <td class="text-center negrita">{{data.Item}}</td>
                <td>{{data.Referencia}}</td>
                <td class="text-center negrita textGreen">{{data.Cantidad | number : '1.2-2'}}</td>
                <td class="text-center">{{data.Material}}</td>
                <td class="text-center"><b>{{data.Ancho | number : '1.2-2'}}</b></td>
                <td class="text-center">{{data.Unidad}}</td>
                <td class="text-center negrita textGreen">{{data.Rollos}}</td>
                <td class="text-center" style="text-align: center;" pFrozenColumn alignFrozen="right" [frozen]="true"><p-button id="botonDetalles" icon="pi pi-eye" styleClass="p-button-rounded p-button-success" (click)="consultarDetallesInventario(data.Cliente, data.Orden, data.Bodega)"></p-button></td>
              </tr>
            </ng-template>
            <ng-template pTemplate="footer">
              <tr>
                <td class="text-right" colspan="5">Totales: </td>
                <td class="text-center textGreen">{{calcularTotalKg(dtSellado, inventarioSellado) | number : '1.2-2'}}</td>
                <td class="text-center">Kg</td>
                <td class="text-center" colspan="2"></td>
                <td class="text-center textGreen">{{calcularTotalRollos(dtSellado, inventarioSellado)}}</td>
                <td></td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>
    </p-tabPanel>

    <!--* PRODUCTO INTERMEDIO DETALLADO -->
    <p-tabPanel
      header="Inventario Detallado"
      leftIcon="pi pi-th-large"
      tooltip="Información del inventario detallado por rollo">

      <!--* Botón Excel Detallado-->
      <p-toolbar styleClass="mb-3 gap-3">
        <div class="row" style="width: 100%;">
          <div class="d-grid gap-2 d-md-flex justify-content-md-end p-2">
            <!--<button pButton pRipple label="Cambiar Ubicación" [disabled]="selectedRolls.length == 0" icon="pi pi-arrow-right-arrow-left"class="p-button-outlined p-button-success" id="reubicar" (click)="changeUbications = true"></button>-->
            <button pButton pRipple label="Exportar a Excel" icon="pi pi-file-excel"class="p-button-success" id="exportar2" (click)="createExcel()"></button>
          </div>
        </div>
      </p-toolbar>

      <!--*Tabla 2-->
      <div class="mb-3" *ngIf="!cargando">
        <div class="row g-3" id="table">
          <p-table
            #dtDetailsProdIntermedio
            [value]="inventoryRolls"
            [resizableColumns]="true"
            columnResizeMode="expand"
            styleClass="p-datatable-gridlines p-datatable-sm"
            responsiveLayout="scroll"
            [rowHover]="true"
            dataKey="roll"
            [scrollable]="true"
            scrollHeight="50rem"
            [paginator]="true"
            [rows]="20"
            [rowsPerPageOptions]="[10, 20, 50, 100]"
            [showCurrentPageReport]="true"
            currentPageReportTemplate="Mostrando del {first} al {last} de {totalRecords} registros"
            *ngIf="!cargando">
            <ng-template pTemplate="header" >
              <tr>
                <th>
                  <!--!<p-button class="p-button-rounded" severity="danger" icon="pi pi-eraser" type="button" label="Limpiar" [disabled]="selectedRolls.length == 0" (click)="deselectionAll()" pTooltip="Limpiar selección de rollos de la tabla" tooltipPosition="top"></p-button>-->
                </th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'roll', 'contains', dtDetailsProdIntermedio)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'initialWarehouse', 'contains', dtDetailsProdIntermedio)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'ot', 'contains', dtDetailsProdIntermedio)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'client', 'contains', dtDetailsProdIntermedio)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'item', 'contains', dtDetailsProdIntermedio)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'reference', 'contains', dtDetailsProdIntermedio)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'qty', 'contains', dtDetailsProdIntermedio)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'material', 'contains', dtDetailsProdIntermedio)"></th>
                <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'broad', 'contains', dtDetailsProdIntermedio)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'unit', 'contains', dtDetailsProdIntermedio)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'ubication', 'contains', dtDetailsProdIntermedio)"></th>
                <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'actualWarehouse', 'contains', dtDetailsProdIntermedio)"></th>
              </tr>
              <tr>
                <th class="text-center" pFrozenColumn alignFrozen="left" [frozen]="true">#</th>
                <!--!<th class="text-center" style="width: 4rem"><p-checkbox (click)="selectionAll()"></p-checkbox></th>-->
                <th class="text-center" pSortableColumn="roll">Rollo <p-sortIcon field="roll"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="initialWarehouse">Bod. Inicial <p-sortIcon field="initialWarehouse"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="ot">Orden Trabajo <p-sortIcon field="ot"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="client">Cliente <p-sortIcon field="client"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="item">Item <p-sortIcon field="item"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="reference">Referencia <p-sortIcon field="Referencia"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="qty">Cantidad (Kg) <p-sortIcon field="qty"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="material">Material <p-sortIcon field="material"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="broad">Ancho <p-sortIcon field="broad"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="unit">Unidad <p-sortIcon field="unit"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="ubication">Ubicación <p-sortIcon field="ubication"></p-sortIcon></th>
                <th class="text-center" pSortableColumn="actualWarehouse">Bod. Actual <p-sortIcon field="actualWarehouse"></p-sortIcon></th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-data let-rowIndex="rowIndex">
              <tr>
                <td class="text-center" pFrozenColumn alignFrozen="left" [frozen]="true">{{rowIndex + 1}}</td>
                <!--!<td class="text-center"><p-tableCheckbox [value]="data"/></td>-->
                <td class="text-center"><b>{{data.roll}}</b></td>
                <td class="text-center">{{data.initialWarehouse}}</td>
                <td class="text-center"><b>{{data.ot}}</b></td>
                <td>{{data.client}}</td>
                <td class="text-center"><b>{{data.item }}</b></td>
                <td>{{data.reference}}</td>
                <td class="text-center textGreen"><b>{{data.qty | number : '1.2-2'}}</b></td>
                <td class="text-center">{{data.material}}</td>
                <td class="text-center"><b>{{data.broad | number : '1.2-2'}}</b></td>
                <td class="text-center">{{data.unit}}</td>
                <td class="text-center"><b>{{data.ubication}}</b></td>
                <td class="text-center">{{data.actualWarehouse}}</td>
              </tr>
            </ng-template>
            <ng-template pTemplate="footer">
              <tr>
                <td class="text-right" colspan="7">Totales: </td>
                <td class="text-center textGreen">{{qtyTotal() | number : '1.2-2'}}</td>
                <td class="text-center">Kg</td>
                <td class="text-center" colspan="4"></td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>
    </p-tabPanel>

  </p-tabView>
</p-card>

<!--* Inventario detallado de rollos por OT y Bodega-->
<p-dialog [(visible)]="inventario" [style]="{width: '90vw'}" [contentStyle]="{'overflow':'visible'}" [resizable]="true" header="Inventario Detallado" [modal]="true" styleClass="p-fluid">
  <ng-template pTemplate="content">
    <p-table
      #dtDetallado
      [value]="inventarioDetallado"
      [resizableColumns]="true"
      columnResizeMode="expand"
      styleClass="p-datatable-gridlines p-datatable-sm"
      responsiveLayout="scroll"
      [rowHover]="true"
      dataKey="id"
      [scrollable]="true"
      scrollHeight="50rem">
      <ng-template pTemplate="header">
        <tr class="font-size-16" id="filtros">
          <th pFrozenColumn alignFrozen="left" [frozen]="true"><button pButton pRipple pTooltip="Exportar a Excel" icon="pi pi-file-excel" class="p-button-success" id="exportar3" (click)="crearExcelDetallado()"></button></th>
          <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Rollo', 'contains', dtDetallado)"></th>
          <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Orden', 'contains', dtDetallado)"></th>
          <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Cliente', 'contains', dtDetallado)"></th>
          <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Item', 'contains', dtDetallado)"></th>
          <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Referencia', 'contains', dtDetallado)"></th>
          <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Cantidad', 'contains', dtDetallado)"></th>
          <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Presentacion', 'contains', dtDetallado)"></th>
          <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Fecha', 'contains', dtDetallado)"></th>
          <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Ubicacion', 'contains', dtDetallado)"></th>
          <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Bodega_Actual', 'contains', dtDetallado)"></th>
          <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Extrusion', 'contains', dtDetallado)"></th>
          <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'ProductoIntermedio', 'contains', dtDetallado)"></th>
          <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Impresion', 'contains', dtDetallado)"></th>
          <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Rotograbado', 'contains', dtDetallado)"></th>
          <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Sellado', 'contains', dtDetallado)"></th>
          <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Calidad', 'contains', dtDetallado)"></th>
          <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'Despacho', 'contains', dtDetallado)"></th>
        </tr>
        <tr>
          <th pFrozenColumn alignFrozen="left" [frozen]="true">#</th>
          <th pSortableColumn="Rollo">Rollo <p-sortIcon field="Rollo"></p-sortIcon></th>
          <th pSortableColumn="Orden">OT <p-sortIcon field="Orden"></p-sortIcon></th>
          <th pSortableColumn="Cliente">Cliente <p-sortIcon field="Cliente"></p-sortIcon></th>
          <th pSortableColumn="Item">Item <p-sortIcon field="Item"></p-sortIcon></th>
          <th pSortableColumn="Referencia">Referencia <p-sortIcon field="Referencia"></p-sortIcon></th>
          <th pSortableColumn="Cantidad">Cantidad <p-sortIcon field="Cantidad"></p-sortIcon></th>
          <th pSortableColumn="Presentacion">Und <p-sortIcon field="Presentacion"></p-sortIcon></th>
          <th pSortableColumn="Fecha">Fecha <p-sortIcon field="Fecha"></p-sortIcon></th>
          <th pSortableColumn="Bodega_Actual">Bodega Actual <p-sortIcon field="Bodega_Actual"></p-sortIcon></th>
          <th pSortableColumn="Ubicacion">Ubicación <p-sortIcon field="Ubicacion"></p-sortIcon></th>
          <th pSortableColumn="Extrusion">EXT <p-sortIcon field="Extrusion"></p-sortIcon></th>
          <th pSortableColumn="ProductoIntermedio">PROD. INTERM. <p-sortIcon field="ProductoIntermedio"></p-sortIcon></th>
          <th pSortableColumn="Impresion">IMP <p-sortIcon field="Impresion"></p-sortIcon></th>
          <th pSortableColumn="Rotograbado">ROTO <p-sortIcon field="Rotograbado"></p-sortIcon></th>
          <th pSortableColumn="Sellado">SELLA <p-sortIcon field="Sellado"></p-sortIcon></th>
          <th pSortableColumn="Calidad">CALIDAD <p-sortIcon field="Calidad"></p-sortIcon></th>
          <th pSortableColumn="Despacho">DESPACHO <p-sortIcon field="Despacho"></p-sortIcon></th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-data let-rowIndex="rowIndex">
        <tr>
          <td pFrozenColumn alignFrozen="left" [frozen]="true"><b>{{rowIndex + 1}}</b></td>
          <td>{{data.Rollo}}</td>
          <td>{{data.Orden}}</td>
          <td>{{data.Cliente}}</td>
          <td>{{data.Item}}</td>
          <td>{{data.Referencia}}</td>
          <td>{{data.Cantidad | number : '1.2-2'}}</td>
          <td>{{data.Presentacion}}</td>
          <td>{{data.Fecha}}</td>
          <td>{{data.Bodega_Actual}}</td>
          <td>{{data.Ubicacion}}</td>
          <td>{{data.Extrusion}}</td>
          <td>{{data.ProductoIntermedio}}</td>
          <td>{{data.Impresion}}</td>
          <td>{{data.Rotograbado}}</td>
          <td>{{data.Sellado}}</td>
          <td>{{data.Calidad}}</td>
          <td>{{data.Despacho}}</td>
        </tr>
      </ng-template>
    </p-table>
  </ng-template>
</p-dialog>

<!--* Imagen del plano de la bodega de rollos -->
<p-dialog [(visible)]="warehouse" [style]="{width: '35vw'}" [contentStyle]="{'overflow':'visible'}" [resizable]="true" header="Plano bodega de rollos" [modal]="true" styleClass="p-fluid">
  <ng-template pTemplate="content">
    <img src="../assets/Background/BODEGA-ROLLOS-PL.jpg"/>
  </ng-template>
</p-dialog>

<!--* Modal cambios de ubicación de rollo -->
<p-dialog [(visible)]="changeUbications" [style]="{width: '70vw'}" [resizable]="true" header="Reubicación de rollos" [modal]="true">
  <br>
  <!--* Formulario-->
  <form [formGroup]="form">
    <div class="mb-3">
      <div class="row g-4">
       
        <!-- Numero de Rollo -->
        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-4 col-xl-2 col-xxl-2">
          <span class="p-input-icon-left p-float-label">
            <i class="pi pi-search"></i>
            <input formControlName="roll" id="roll" (keyup.enter)="searchForRolls()" autocomplete="off" type="number" pInputText/>
            <label for="roll">N° Rollo</label>
          </span>
        </div>

         <!--* Ubicación-->
        <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4 col-xl-4 col-xxl-2">
          <span class="p-float-label">
            <p-dropdown formControlName="ubication" id="Ubicacion" [options]="ubications" optionValue="ubR_Id" optionLabel="ubR_Nombre" (onChange)="getSubUbications()" [autoDisplayFirst]="false"></p-dropdown>
            <label for="ubication">Ubicación*</label>
          </span>
        </div>
  
        <!--* Sub ubicación-->
        <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4 col-xl-4 col-xxl-2">
          <span class="p-float-label">
            <p-dropdown formControlName="subUbication" id="subUbication" [options]="subUbications" optionValue="ubR_SubId" optionLabel="ubR_SubNombre" [autoDisplayFirst]="false"></p-dropdown>
            <label for="subUbication">Sub Ubicación*</label>
          </span>
        </div>

        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-8 col-xl-4 col-xxl-6">
          <span class="p-float-label">
            <textarea formControlName="observation" [rows]="1" pInputTextarea></textarea>
            <label for="textarea">Motivo de reubicación*</label>
          </span>
        </div>

      </div>
    </div> 
    <!--* Botones-->
    <div class="mb-3">
      <div class="row g-3">
        <div class="d-grid gap-3 d-md-flex justify-content-md-center">
          <button pButton pRipple class="p-button-danger" icon="pi pi-check" [disabled]="form.invalid || selectedRolls.length == 0" type="button" label="Reubicar rollos" (click)="reubicateRolls()" id="botones1"></button>
          <button pButton pRipple class="p-button-outlined p-button-secondary" type="button" icon="pi pi-eraser" label="Limpiar campos" (click)="clearFields()" id="botones2"></button>
        </div>
      </div>
    </div>
  </form>

  <p-divider></p-divider>

  <!--* Tabla de rollos a reubicar-->
  <p-table 
    #tableReubication
    [value]="selectedRolls" 
    [tableStyle]="{ 'min-width': '50rem' }" 
    styleClass="p-datatable-sm"
    [resizableColumns]="true"
    columnResizeMode="expand"
    responsiveLayout="scroll"
    [rowHover]="true">
      <ng-template pTemplate="header">
          <tr>
            <th></th>
            <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'roll', 'contains', tableReubication)"></th>
            <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'ot', 'contains', tableReubication)"></th>
            <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'item', 'contains', tableReubication)"></th>
            <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'reference', 'contains', tableReubication)"></th>
            <th><input pInputText type="number" style="width: 100%;" (input)="aplicarfiltro($event, 'qty', 'contains', tableReubication)"></th>
            <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'presentation', 'contains', tableReubication)"></th>
            <th><input pInputText type="text" style="width: 100%;" (input)="aplicarfiltro($event, 'ubication', 'contains', tableReubication)"></th>
            <th></th>
          </tr>
          <tr>
              <th class="text-center">N°</th>
              <th class="text-center">Rollo</th>
              <th class="text-center">OT</th>
              <th class="text-center">Item</th>
              <th class="text-center">Referencia</th>
              <th class="text-center">Peso</th>
              <th class="text-center">Unidad</th>
              <th class="text-center">Ubicación</th>
              <th class="text-center">Quitar</th>
          </tr>
      </ng-template>
      <ng-template pTemplate="body" let-data let-rowIndex="rowIndex">
          <tr class="cursor">
              <td class="text-center">{{  (selectedRolls.length - 1) - rowIndex + 1 }}</td>
              <td class="text-center"><b>{{ data.roll }}</b></td>
              <td class="text-center">{{ data.ot }}</td>
              <td class="text-center"><b>{{ data.item }}</b></td>
              <td>{{ data.reference }}</td>
              <td class="text-center textGreen"><b>{{ data.qty }}</b></td>
              <td class="text-center">{{ 'Kg' }}</td>
              <td class="text-center">{{ data.ubication }}</td>
              <td class="text-center"><p-button class="p-button-rounded" severity="danger" icon="pi pi-trash" type="button" (click)="quitRoll(data)"></p-button></td>
          </tr>
      </ng-template>
  </p-table>  
</p-dialog>



